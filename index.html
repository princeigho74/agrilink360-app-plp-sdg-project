<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AgriLink360 ‚Äî Reducing Food Waste, Increasing Farm Produce Distribution, Feeding Communities</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@17/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gray-50">
<div id="root"></div>

<script type="text/babel">
const { useState, useEffect } = React;

// ===================== UTILS =====================
const uid = (prefix='id') => prefix+'_'+Math.random().toString(36).slice(2,9);

// ===================== AFRICAN COUNTRIES =====================
const AFRICAN_COUNTRIES = [
  "Nigeria","Ghana","Kenya","Uganda","Senegal","Ethiopia","Cameroon",
  "South Africa","Tanzania","Morocco","Algeria","Egypt","Zimbabwe","Namibia",
  "Mali","Ivory Coast","Rwanda","Botswana","Zambia","Sudan","Tunisia","Libya",
  "Mauritius","Mozambique","Burundi","Gabon","Sierra Leone","Lesotho","Benin",
  "Burkina Faso","Djibouti","Equatorial Guinea","Gambia","Guinea","Guinea-Bissau",
  "Liberia","Malawi","Niger","Sao Tome and Principe","Seychelles","Somalia"
];

// ===================== PRODUCTS =====================
let PRODUCTS = [
  {id:1,title:"Rice",desc:"Long grain rice",qty:"100 bags",price:50,location:"Lagos, Nigeria",sensor:{temp:26,humidity:60}},
  {id:2,title:"Beans",desc:"Brown beans",qty:"200 bags",price:45,location:"Kano, Nigeria",sensor:{temp:28,humidity:70}},
  {id:3,title:"Cassava",desc:"Fresh cassava tubers",qty:"500kg",price:30,location:"Accra, Ghana",sensor:{temp:29,humidity:85}},
  {id:4,title:"Onions",desc:"Red onions",qty:"100 bags",price:40,location:"Nairobi, Kenya",sensor:{temp:25,humidity:65}},
  {id:5,title:"Tomatoes",desc:"Fresh tomatoes",qty:"200 crates",price:35,location:"Kampala, Uganda",sensor:{temp:31,humidity:88}},
  {id:6,title:"Fish",desc:"Smoked fish",qty:"50 boxes",price:80,location:"Dakar, Senegal",sensor:{temp:27,humidity:55}},
  {id:7,title:"Pepper",desc:"Chili pepper",qty:"70 bags",price:20,location:"Addis Ababa, Ethiopia",sensor:{temp:30,humidity:75}},
  {id:8,title:"Garri",desc:"Ijebu garri",qty:"300 bags",price:25,location:"Abuja, Nigeria",sensor:{temp:26,humidity:60}},
  {id:9,title:"Bush Meat",desc:"Game meat",qty:"20 units",price:150,location:"Yaound√©, Cameroon",sensor:{temp:28,humidity:77}},
  {id:10,title:"Maize",desc:"Yellow maize",qty:"150 bags",price:40,location:"Lusaka, Zambia",sensor:{temp:27,humidity:70}},
  {id:11,title:"Yam",desc:"Fresh yam tubers",qty:"120 bags",price:55,location:"Abuja, Nigeria",sensor:{temp:26,humidity:65}},
];

// ===================== USERS =====================
let USERS = []; // will store buyers and farmers

// ===================== MARKETPLACE =====================
let trialCount = 0;
function Marketplace({user, onBuy, onView, query, setQuery, purchaseHistory, setPurchaseHistory}) {
  const [countryFilter,setCountryFilter] = useState('');

  const filtered = PRODUCTS.filter(p=>
    (p.title.toLowerCase().includes(query.toLowerCase()) ||
     p.location.toLowerCase().includes(query.toLowerCase())) &&
    (countryFilter ? p.location.includes(countryFilter) : true)
  );

  const handleBuy = (p) => {
    if(!user || user.type !== 'buyer') { alert("Only buyers can purchase."); return; }
    trialCount++;
    if(trialCount > 3){
      alert("‚ö†Ô∏è Free trial limit reached. Please proceed to payment.");
      return;
    }
    onBuy(p);
    setPurchaseHistory(prev => [...prev, p]);
  };

  return (
    <div className="max-w-7xl mx-auto p-6">
      <h2 className="text-2xl font-bold text-green-700 mb-4">Marketplace</h2>
      <div className="flex flex-col sm:flex-row gap-2 mb-4">
        <input value={query} onChange={e=>setQuery(e.target.value)} placeholder="Search product..." className="border px-3 py-2 rounded flex-1"/>
        <select value={countryFilter} onChange={e=>setCountryFilter(e.target.value)} className="border px-3 py-2 rounded">
          <option value="">All Countries</option>
          {AFRICAN_COUNTRIES.map(c=><option key={c} value={c}>{c}</option>)}
        </select>
      </div>
      <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
        {filtered.map(p=>(
          <div key={p.id} className="bg-white rounded shadow p-4">
            <h3 className="text-lg font-semibold">{p.title}</h3>
            <p className="text-sm text-gray-600">{p.desc}</p>
            <p className="text-xs text-gray-500">{p.qty} ‚Ä¢ {p.location}</p>
            <p className="text-green-600 mt-1 font-semibold">Fresh & Available for Sale</p>
            <p className="mt-2 font-bold">${p.price}</p>
            <div className="mt-3 flex flex-col sm:flex-row gap-2">
              <button onClick={()=>handleBuy(p)} className="bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700 w-full sm:w-auto transition-colors">Buy</button>
              <button onClick={()=>onView(p)} className="bg-blue-600 text-white px-3 py-2 rounded hover:bg-blue-700 w-full sm:w-auto transition-colors">View</button>
            </div>
          </div>
        ))}
      </div>
      {user && user.type==='buyer' && <AIRecommendations history={purchaseHistory} />}
    </div>
  );
}

// ===================== AI RECOMMENDATIONS =====================
function AIRecommendations({history}) {
  if(history.length===0) return null;
  const recommended = PRODUCTS.filter(p => !history.some(h => h.id===p.id)).slice(0,3);
  return (
    <div className="max-w-7xl mx-auto p-4">
      <h2 className="text-2xl font-bold text-green-700 mb-4">AI Recommended Products</h2>
      <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
        {recommended.map(p=>(
          <div key={p.id} className="bg-white rounded shadow p-4">
            <h3 className="font-semibold">{p.title}</h3>
            <p className="text-sm text-gray-600">{p.desc}</p>
            <p className="text-xs text-gray-500">{p.qty} ‚Ä¢ {p.location}</p>
            <p className="text-green-600 mt-1 font-semibold">Fresh & Available for Sale</p>
            <p className="mt-2 font-bold">${p.price}</p>
          </div>
        ))}
      </div>
    </div>
  );
}

// ===================== DASHBOARD =====================
function Dashboard(){
  const [orders,setOrders]=useState([
    {id:'A101',customer:'John Doe',quantity:10,status:'Delivered'},
    {id:'A102',customer:'Jane Smith',quantity:5,status:'Pending'},
    {id:'A103',customer:'Mark Lee',quantity:8,status:'In Transit'},
  ]);

  useEffect(()=>{
    const ctx=document.getElementById('ordersChart');
    if(ctx){
      new Chart(ctx,{
        type:'line',
        data:{
          labels:['Jan','Feb','Mar','Apr','May'],
          datasets:[{
            label:'Orders',
            data:[12,19,3,5,2],
            backgroundColor:'rgba(34,197,94,0.2)',
            borderColor:'rgba(34,197,94,1)',
            borderWidth:2,
            fill:true,
            tension:0.3
          }]
        },
        options:{responsive:true,maintainAspectRatio:false}
      });
    }
  },[]);

  return (
    <div className="p-4 space-y-6">
      <section className="bg-white p-6 rounded-lg shadow text-center">
        <h2 className="text-2xl font-bold text-green-700 mb-2">üåç AgriLink360 Dashboard</h2>
        <p className="text-gray-600">Smart farming insights and order monitoring</p>
        <div className="mt-2 flex justify-center gap-3 flex-wrap">
          <img src="https://raw.githubusercontent.com/princeigho74/images/main/419a27c026391cf_file_0000000094086243ab055dcc588f8dff_wm%20(2).png" className="h-24 rounded" />
          <img src="https://raw.githubusercontent.com/princeigho74/images/main/a545f1608f40b66_file_000000008b3061f49ccd7e1ca96868b3_wm%20(1).png" className="h-24 rounded" />
          <img src="https://raw.githubusercontent.com/princeigho74/images/main/cf992f79720b785_file_00000000eb7462438da6dcca8d2146d4_wm.png" className="h-24 rounded" />
        </div>
      </section>

      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div className="bg-white p-4 rounded shadow">
          <h2 className="text-gray-700 font-bold">Total Orders</h2>
          <p className="text-2xl font-bold">{orders.length}</p>
        </div>
        <div className="bg-white p-4 rounded shadow">
          <h2 className="text-gray-700 font-bold">Stock Level</h2>
          <p className="text-2xl font-bold">{PRODUCTS.length}</p>
        </div>
        <div className="bg-white p-4 rounded shadow">
          <h2 className="text-gray-700 font-bold">IoT Devices</h2>
          <p className="text-sm text-gray-700">Monitoring active devices</p>
        </div>
      </div>

      <div className="bg-white p-4 rounded shadow h-80">
        <canvas id="ordersChart"></canvas>
      </div>
    </div>
  );
}

// ===================== IOT MONITOR =====================
function IotMonitor(){
  const [iotData,setIotData]=useState(PRODUCTS.map(p=>({
    title:p.title,
    location:p.location,
    temp:p.sensor.temp,
    humidity:p.sensor.humidity
  })));
  const [countryFilter,setCountryFilter] = useState('');

  const filteredData = iotData.filter(d=> countryFilter ? d.location.includes(countryFilter) : true);

  return (
    <div className="max-w-7xl mx-auto p-6">
      <h2 className="text-2xl font-bold text-green-700 mb-4">IoT Monitor & Spoilage Alert</h2>
      <div className="flex gap-2 mb-4">
        <select value={countryFilter} onChange={e=>setCountryFilter(e.target.value)} className="border px-3 py-2 rounded">
          <option value="">All Countries</option>
          {AFRICAN_COUNTRIES.map(c=><option key={c} value={c}>{c}</option>)}
        </select>
      </div>
      <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
        {filteredData.map(d=>(
          <div key={d.title} className={`p-4 rounded shadow ${d.temp>30?'bg-red-200':d.humidity>80?'bg-yellow-200':'bg-green-200'}`}>
            <h3 className="font-semibold">{d.title}</h3>
            <p className="text-sm text-gray-700">{d.location}</p>
            <p>üå°Ô∏è Temp: {d.temp}¬∞C</p>
            <p>üíß Humidity: {d.humidity}%</p>
            <p className="text-xs mt-1">
              {d.temp>30?'‚ö†Ô∏è High Temperature - Spoilage Risk':''}
              {d.humidity>80?' ‚ö†Ô∏è High Humidity':''}
            </p>
          </div>
        ))}
      </div>
    </div>
  );
}

// ===================== AUTH =====================
function Auth({onLogin}){
  const [mode,setMode]=useState('login');
  const [name,setName]=useState('');
  const [email,setEmail]=useState('');
  const [pw,setPw]=useState('');
  const [type,setType]=useState('farmer');

  const register=e=>{
    e.preventDefault();
    if(!name||!email||!pw){alert('Fill all fields');return;}
    const u={id:uid(type),name,email,password:pw,type};
    USERS.push(u);
    onLogin(u);
  };

  const login=e=>{
    e.preventDefault();
    const u=USERS.find(x=>x.email===email && x.password===pw);
    if(!u){alert('Invalid credentials');return;}
    onLogin(u);
  };

  return (
    <div className="max-w-md mx-auto mt-10 bg-white p-6 rounded shadow">
      <h2 className="text-xl font-bold mb-4">{mode==='login'?'Login':'Register'}</h2>
      <form onSubmit={mode==='login'?login:register} className="space-y-3">
        {mode==='register' && (
          <input value={name} onChange={e=>setName(e.target.value)} placeholder="Full Name" className="w-full p-2 border rounded"/>
        )}
        <input value={email} onChange={e=>setEmail(e.target.value)} type="email" placeholder="Email" className="w-full p-2 border rounded"/>
        <input value={pw} onChange={e=>setPw(e.target.value)} type="password" placeholder="Password" className="w-full p-2 border rounded"/>
        {mode==='register' && (
          <select value={type} onChange={e=>setType(e.target.value)} className="w-full p-2 border rounded">
            <option value="farmer">Farmer</option>
            <option value="buyer">Buyer</option>
          </select>
        )}
        <button type="submit" className="w-full bg-green-600 text-white py-2 rounded">{mode==='login'?'Login':'Register'}</button>
      </form>
      <div className="mt-3 text-sm text-center">
        {mode==='login' ? (
          <span>New user? <button onClick={()=>setMode('register')} className="text-green-600">Register</button></span>
        ) : (
          <span>Already registered? <button onClick={()=>setMode('login')} className="text-green-600">Login</button></span>
        )}
      </div>
    </div>
  );
}

// ===================== CONTACT =====================
function Contact(){
  return (
    <div className="max-w-2xl mx-auto p-6 bg-white rounded shadow mt-6">
      <h2 className="text-2xl font-bold mb-4 text-green-700">Contact Us</h2>
      <p>Email: <a href="mailto:Smartxpress74@gmail.com" className="text-blue-600">Smartxpress74@gmail.com</a></p>
      <p>Phone: <a href="tel:+2348065292102" className="text-blue-600">+2348065292102</a></p>
      <p className="mt-2">We provide Pan-African food distribution and smart farming solutions.</p>
    </div>
  );
}

// ===================== TRANSACTIONS =====================
function TransactionsGallery({history}){
  if(history.length===0) return (
    <div className="max-w-3xl mx-auto p-6 bg-white rounded shadow mt-6 text-center">
      <p className="text-gray-500">No transactions yet.</p>
    </div>
  );

  return (
    <div className="max-w-7xl mx-auto p-6">
      <h2 className="text-2xl font-bold text-green-700 mb-4">Transactions Gallery</h2>
      <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
        {history.map((p,idx)=>(
          <div key={idx} className="bg-white rounded shadow p-4">
            <h3 className="font-semibold">{p.title}</h3>
            <p className="text-sm text-gray-600">{p.desc}</p>
            <p className="text-xs text-gray-500">{p.qty} ‚Ä¢ {p.location}</p>
            <p className="text-green-600 mt-1 font-semibold">Purchased</p>
          </div>
        ))}
      </div>
    </div>
  );
}

// ===================== HEADER =====================
function Header({current,setCurrent,user,signout}){
  const [menuOpen,setMenuOpen]=use function Header({current,setCurrent,user,signout}){
  const [menuOpen,setMenuOpen]=useState(false);
  return (
    <header className="bg-white shadow sticky top-0 z-40">
      <div className="max-w-7xl mx-auto px-4 flex justify-between items-center h-16">
        <div className="flex items-center space-x-3">
          <div className="w-10 h-10 rounded-md bg-green-600 text-white flex items-center justify-center font-bold">A</div>
          <div className="flex flex-col">
            <div className="text-lg font-semibold">AgriLink360</div>
            <div className="text-xs text-gray-500">
              Reducing Food Waste, Increasing Farm Produce Distribution and Feeding Communities
            </div>
          </div>
        </div>

        {/* Hamburger Menu */}
        <div className="sm:hidden">
          <button onClick={()=>setMenuOpen(!menuOpen)} className="p-2 border rounded">
            ‚ò∞
          </button>
        </div>

        <nav className={`flex-col sm:flex-row sm:flex items-center gap-2 ${menuOpen ? "flex" : "hidden"} sm:flex`}>
          {['auth','dashboard','market','iot','transactions','contact'].map(p=>(
            <button key={p} className={`px-3 py-2 rounded ${current===p?'bg-green-100':''}`} onClick={()=>{setCurrent(p); setMenuOpen(false);}}>
              {p==='market'?'Marketplace':
               p==='iot'?'AI IoT Monitor':
               p==='dashboard'?'Dashboard':
               p==='auth'?'Sign in / Register':
               p==='transactions'?'Transactions':
               'Contact'}
            </button>
          ))}
          {user && (
            <div className="flex items-center gap-2 mt-2 sm:mt-0">
              <span className="text-sm">{user.name}</span>
              <button onClick={signout} className="px-3 py-1 border rounded text-sm">Sign out</button>
            </div>
          )}
        </nav>
      </div>
    </header>
  );
}

// ===================== APP ROOT =====================
function App(){
  const [current,setCurrent]=useState('auth');
  const [user,setUser]=useState(null);
  const [query,setQuery]=useState('');
  const [selected,setSelected]=useState(null);
  const [purchaseHistory,setPurchaseHistory]=useState([]);

  return (
    <div>
      <Header current={current} setCurrent={setCurrent} user={user} signout={()=>setUser(null)} />

      {current==='auth' && <Auth onLogin={setUser} />}
      {current==='dashboard' && user && <Dashboard />}
      {current==='market' && <Marketplace 
        user={user} 
        query={query} 
        setQuery={setQuery} 
        onBuy={(p)=>alert("Bought "+p.title)} 
        onView={setSelected} 
        purchaseHistory={purchaseHistory} 
        setPurchaseHistory={setPurchaseHistory} />}
      {current==='iot' && <IotMonitor />}
      {current==='transactions' && <TransactionsGallery history={purchaseHistory} />}
      {current==='contact' && <Contact />}

      {selected && (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
          <div className="bg-white p-6 rounded shadow max-w-sm w-full">
            <h2 className="text-lg font-bold mb-2">{selected.title}</h2>
            <p>{selected.desc}</p>
            <p className="text-sm text-gray-600">{selected.qty} ‚Ä¢ {selected.location}</p>
            <p className="text-green-600 mt-1 font-semibold">Fresh & Available for Sale</p>
            <p className="mt-2 font-bold">${selected.price}</p>
            <button onClick={()=>setSelected(null)} className="mt-4 w-full bg-red-600 text-white px-3 py-2 rounded hover:bg-red-700 transition-colors">Close</button>
          </div>
        </div>
      )}
    </div>
  );
}

ReactDOM.render(<App />, document.getElementById('root'));
</script>
</body>
</html>
