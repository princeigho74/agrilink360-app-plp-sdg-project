<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AgriLink360 ‚Äî Pan-African Food Distribution</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@17/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://checkout.flutterwave.com/v3.js"></script>
</head>
<body class="bg-gray-50">
  <div id="root"></div>

  <script type="text/babel">
    const { useState } = React;

    // Utils
    const uid = (prefix='id') => prefix+'_'+Math.random().toString(36).slice(2,9);

    // Product Data
    const PRODUCTS = [
      {id:1,title:"Rice",desc:"Long grain rice",qty:"100 bags",price:50,location:"Lagos, Nigeria",sensor:{temp:26,humidity:60}},
      {id:2,title:"Beans",desc:"Brown beans",qty:"200 bags",price:45,location:"Kano, Nigeria",sensor:{temp:28,humidity:70}},
      {id:3,title:"Cassava",desc:"Fresh cassava tubers",qty:"500kg",price:30,location:"Accra, Ghana",sensor:{temp:29,humidity:85}},
      {id:4,title:"Onions",desc:"Red onions",qty:"100 bags",price:40,location:"Nairobi, Kenya",sensor:{temp:25,humidity:65}},
      {id:5,title:"Tomatoes",desc:"Fresh tomatoes",qty:"200 crates",price:35,location:"Kampala, Uganda",sensor:{temp:31,humidity:88}},
      {id:6,title:"Fish",desc:"Smoked fish",qty:"50 boxes",price:80,location:"Dakar, Senegal",sensor:{temp:27,humidity:55}},
      {id:7,title:"Pepper",desc:"Chili pepper",qty:"70 bags",price:20,location:"Addis Ababa, Ethiopia",sensor:{temp:30,humidity:75}},
      {id:8,title:"Garri",desc:"Ijebu garri",qty:"300 bags",price:25,location:"Abuja, Nigeria",sensor:{temp:26,humidity:60}},
      {id:9,title:"Bush Meat",desc:"Game meat",qty:"20 units",price:150,location:"Yaound√©, Cameroon",sensor:{temp:28,humidity:77}},
    ];

    // Free trial counter
    let trialCount = 0;

    // Header
    function Header({current,setCurrent}){
      return (
        <header className="bg-green-700 text-white shadow sticky top-0 z-40">
          <div className="max-w-7xl mx-auto px-4 flex justify-between items-center h-16">
            <h1 className="text-lg font-bold">AgriLink360</h1>
            <nav className="flex items-center space-x-4">
              {['market','iot','dashboard'].map(p=>(
                <button key={p}
                  className={`px-3 py-1 rounded ${current===p?'bg-green-900':''}`}
                  onClick={()=>setCurrent(p)}>
                  {p==='market'?'Marketplace':p==='iot'?'IoT Monitor':'Dashboard'}
                </button>
              ))}
            </nav>
          </div>
        </header>
      );
    }

    // Marketplace
    function Marketplace({onBuy,onView,query,setQuery}) {
      const filtered = PRODUCTS.filter(p=>
        p.title.toLowerCase().includes(query.toLowerCase()) ||
        p.location.toLowerCase().includes(query.toLowerCase())
      );

      const handleBuy = (p) => {
        trialCount++;
        if(trialCount > 3){
          alert("‚ö†Ô∏è Free trial limit reached. Please proceed to payment.");
          return;
        }
        onBuy(p);
      };

      return (
        <div className="max-w-7xl mx-auto p-6">
          <h2 className="text-2xl font-bold text-green-700 mb-2">Marketplace</h2>
          <p className="mb-6 text-gray-700">
            Welcome to AgriLink360 App... a Smart Farming Technology that reduces food wastes and feeds communities.
          </p>
          <input value={query} onChange={e=>setQuery(e.target.value)} placeholder="Search by product or location..." className="border px-3 py-2 w-full mb-6 rounded"/>
          <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
            {filtered.map(p=>(
              <div key={p.id} className="bg-white rounded shadow p-4">
                <h3 className="text-lg font-semibold">{p.title}</h3>
                <p className="text-sm text-gray-600">{p.desc}</p>
                <p className="text-xs text-gray-500">{p.qty} ‚Ä¢ {p.location}</p>
                <p className="mt-2 font-bold">${p.price}</p>
                <div className="mt-3 flex space-x-2">
                  <button onClick={()=>handleBuy(p)} className="bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700">Buy</button>
                  <button onClick={()=>onView(p)} className="bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700">View</button>
                </div>
              </div>
            ))}
          </div>
        </div>
      );
    }

    // IoT Monitor
    function IoTMonitor(){
      return (
        <div className="max-w-6xl mx-auto p-6">
          <h2 className="text-2xl font-bold text-green-700 mb-4">IoT Monitoring System</h2>
          <p className="text-gray-600 mb-4">Real-time monitoring of temperature and humidity for stored farm produce.</p>
          <div className="grid md:grid-cols-2 gap-6">
            <div className="bg-white rounded shadow p-4">
              <h3 className="font-semibold mb-2">Sensor Data</h3>
              <ul className="text-sm">
                {PRODUCTS.map(p=>(
                  <li key={p.id} className="border-b py-1">
                    {p.title} ‚Äî üå° {p.sensor.temp}¬∞C | üíß {p.sensor.humidity}%
                  </li>
                ))}
              </ul>
            </div>
            <div className="bg-white rounded shadow p-4 flex items-center justify-center">
              <img src="https://drive.google.com/uc?export=view&id=1og1zpEiJUjPrcHPHDXMB_PDwPWCIYbsb" alt="IoT Device" className="rounded w-full h-auto"/>
            </div>
          </div>
        </div>
      );
    }

    // Dashboard
    function Dashboard(){
      return (
        <div className="max-w-7xl mx-auto p-6">
          <h2 className="text-2xl font-bold text-green-700 mb-4">Dashboard</h2>
          <div className="grid md:grid-cols-3 gap-6">
            <div className="bg-white rounded shadow p-4">
              <h3 className="font-semibold">Total Products</h3>
              <p className="text-2xl">{PRODUCTS.length}</p>
            </div>
            <div className="bg-white rounded shadow p-4">
              <h3 className="font-semibold">Active Farmers</h3>
              <p className="text-2xl">150+</p>
            </div>
            <div className="bg-white rounded shadow p-4">
              <h3 className="font-semibold">Sales</h3>
              <p className="text-2xl">$12,450</p>
            </div>
          </div>
          <div className="mt-6">
            <img src="https://drive.google.com/uc?export=view&id=1IPNvlCHmZhEX_ApSgEX9hJDpiBb1H9Ms" alt="Farmer" className="rounded shadow-md w-full max-w-lg mx-auto"/>
          </div>
        </div>
      );
    }

    // Main App
    function App(){
      const [current,setCurrent]=useState('market');
      const [query,setQuery]=useState('');

      const handleBuy = (p)=> alert("You selected: " + p.title);
      const handleView = (p)=> alert("Product: " + p.title + " from " + p.location);

      return (
        <div>
          <Header current={current} setCurrent={setCurrent}/>
          {current==='market' && <Marketplace onBuy={handleBuy} onView={handleView} query={query} setQuery={setQuery}/>}
          {current==='iot' && <IoTMonitor/>}
          {current==='dashboard' && <Dashboard/>}
        </div>
      );
    }

    ReactDOM.render(<App/>,document.getElementById("root"));
  </script>
</body>
</html>
